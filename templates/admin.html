<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../static/css/style.css" />
  </head>
  <body>
    <!-- Header -->
    <header
      class="w-full h-[10vh] min-h-[60px] flex items-center bg-blue-600 px-4 fixed top-0 left-0 z-50"
    >
      <p class="text-white text-sm sm:text-base md:text-lg">
        Python (19877) 8:00-10:30 MW
      </p>
    </header>

    <!-- Hamburger Menu - Mobile only -->
    <div
      class="w-full h-[10vh] flex items-center fixed top-[10vh] left-0 z-40 px-4 lg:hidden bg-white"
    >
      <img
        src="https://cdn-icons-png.flaticon.com/512/1828/1828859.png"
        alt="Menu"
        id="hamburger-icon"
        class="w-6 h-6 cursor-pointer"
      />
    </div>

    <!-- Sidebar -->
    <aside id="sidebar">
      <a href="{{ url_for('admin') }}">User Management</a>
      <a href="{{ url_for('dashboard') }}">Student Management</a>
      <a href="{{ url_for('attendance')}}">Attendance</a>
      <a href="{{ url_for('signin') }}">Logout</a>
    </aside>

    <!-- Overlay -->
    <div id="overlay"></div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %}
    <div class="fixed top-[11vh] left-1/2 transform -translate-x-1/2 z-50 w-96">
      {% for category, message in messages %}
      <div
        class="bg-{% if category == 'error' %}red{% else %}green{% endif %}-500 text-white px-6 py-3 rounded-lg shadow-lg mb-2"
      >
        {{ message }}
      </div>
      {% endfor %}
    </div>
    {% endif %} {% endwith %}

    <!-- Main Content Area -->
    <div class="content-wrapper">
      <!-- Desktop Layout (lg and up) -->
      <div class="hidden lg:flex h-full">
        <!-- Left Column - Admin Form (30%) -->
        <div class="w-[30%] p-4 overflow-y-auto">
          <p class="text-xl font-semibold text-black mb-4">User Management</p>

          <div class="bg-white border-2 border-gray-300 rounded-lg p-6">
            <!-- Admin Image -->
            <div class="w-full flex justify-center mb-6">
              <img
                src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
                alt="user-icon"
                class="w-16 h-16"
              />
            </div>

            <!-- Form -->
            <form
              method="POST"
              action="{% if admin %}{{ url_for('update_admin', id=admin['id']) }}{% else %}{{ url_for('add_admin') }}{% endif %}"
              class="w-full flex flex-col gap-4"
            >
              <input
                type="email"
                name="email"
                value="{% if admin %}{{ admin['email'] }}{% endif %}"
                class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                placeholder="Email"
                required
              />
              <input
                type="password"
                name="password"
                class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                placeholder="{% if admin %}New Password (leave blank to keep current){% else %}Password{% endif %}"
                {%
                if
                not
                admin
                %}required{%
                endif
                %}
              />

              <button
                type="submit"
                class="w-full h-12 text-white rounded bg-blue-600 hover:bg-blue-700 mt-2"
              >
                {% if admin %}Update{% else %}Save{% endif %}
              </button>

              {% if admin %}
              <a
                href="{{ url_for('admin') }}"
                class="w-full h-12 leading-12 text-white rounded bg-gray-500 hover:bg-gray-600 flex justify-center items-center"
              >
                Cancel
              </a>
              {% endif %}
            </form>
          </div>
        </div>

        <!-- Right Column - Admin Table (70%) -->
        <div class="w-[70%] p-4 overflow-y-auto">
          <div class="bg-white rounded-lg shadow-lg">
            <div class="overflow-x-auto lg:mt-11">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-blue-600">
                  <tr>
                    <th
                      class="px-6 py-4 text-left text-sm font-semibold text-white uppercase"
                    >
                      ID
                    </th>
                    <th
                      class="px-6 py-4 text-left text-sm font-semibold text-white uppercase"
                    >
                      EMAIL
                    </th>
                    <th
                      class="px-6 py-4 text-left text-sm font-semibold text-white uppercase"
                    >
                      ACTION
                    </th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                  {% if adminlist %} {% for adm in adminlist %}
                  <tr>
                    <td class="px-6 py-4 text-base text-gray-900">
                      {{ adm['id'] }}
                    </td>
                    <td class="px-6 py-4 text-base text-gray-900">
                      {{ adm['email'] }}
                    </td>
                    <td class="px-6 py-4 text-base">
                      <a
                        href="{{ url_for('update_admin', id=adm['id']) }}"
                        class="text-blue-600 hover:text-blue-800 mr-3 font-medium"
                        >&#128393;</a
                      >
                      <a
                        href="{{ url_for('delete_admin', id=adm['id']) }}"
                        onclick="return confirm('Are you sure you want to delete this admin?')"
                        class="text-red-600 hover:text-red-800 font-medium"
                        >&#9003;</a
                      >
                    </td>
                  </tr>
                  {% endfor %} {% else %}
                  <tr>
                    <td colspan="4" class="px-6 py-4 text-center text-gray-500">
                      No admins found
                    </td>
                  </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile/Tablet Layout (below lg) -->
      <div class="lg:hidden px-4 py-4 pt-[10vh] h-full overflow-y-auto">
        <!-- Admin Profile Section -->
        <div class="w-full flex justify-center mb-8">
          <div
            class="w-full max-w-2xl bg-white border-2 border-gray-300 rounded-lg p-6"
          >
            <p class="text-xl font-semibold text-black mb-4">User Management</p>

            <!-- Admin Image -->
            <div class="w-full flex justify-center mb-6">
              <img
                src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
                alt="user-icon"
                class="w-28 h-28"
              />
            </div>

            <!-- Form -->
            <form
              method="POST"
              action="{% if admin %}{{ url_for('update_admin', id=admin['id']) }}{% else %}{{ url_for('add_admin') }}{% endif %}"
              class="w-full flex flex-col gap-4"
            >
              <input
                type="email"
                name="email"
                value="{% if admin %}{{ admin['email'] }}{% endif %}"
                class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                placeholder="Email"
                required
              />
              <input
                type="password"
                name="password"
                class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                placeholder="{% if admin %}New Password (leave blank to keep current){% else %}Password{% endif %}"
                {%
                if
                not
                admin
                %}required{%
                endif
                %}
              />
              <button
                type="submit"
                class="w-full h-12 text-white rounded bg-blue-600 hover:bg-blue-700 mt-2"
              >
                {% if admin %}Update{% else %}Save{% endif %}
              </button>

              {% if admin %}
              <a
                href="{{ url_for('admin') }}"
                class="w-full h-12 text-center leading-12 text-white rounded bg-gray-500 hover:bg-gray-600"
              >
                Cancel
              </a>
              {% endif %}
            </form>
          </div>
        </div>

        <!-- Admin Table -->
        <div class="w-full flex justify-center mb-8">
          <div
            class="w-full max-w-4xl bg-white rounded-lg overflow-hidden shadow-lg"
          >
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-blue-600">
                  <tr>
                    <th
                      class="px-4 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap"
                    >
                      ID
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap"
                    >
                      EMAIL
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap"
                    >
                      ACTION
                    </th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                  {% if adminlist %} {% for adm in adminlist %}
                  <tr>
                    <td class="px-4 py-4 text-sm text-gray-900">
                      {{ adm['id'] }}
                    </td>
                    <td
                      class="px-4 py-4 text-sm text-gray-900 whitespace-nowrap"
                    >
                      {{ adm['email'] }}
                    </td>
                    <td class="px-4 py-4 text-sm whitespace-nowrap">
                      <a
                        href="{{ url_for('update_admin', id=adm['id']) }}"
                        class="text-blue-600 hover:text-blue-800 mr-2"
                        >&#128393;</a
                      >
                      <a
                        href="{{ url_for('delete_admin', id=adm['id']) }}"
                        onclick="return confirm('Are you sure you want to delete this admin?')"
                        class="text-red-600 hover:text-red-800"
                        >&#9003;</a
                      >
                    </td>
                  </tr>
                  {% endfor %} {% else %}
                  <tr>
                    <td colspan="4" class="px-4 py-4 text-center text-gray-500">
                      No admins found
                    </td>
                  </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer
      class="w-full h-[10vh] min-h-[60px] flex justify-center items-center border-t-2 border-t-gray-200 fixed bottom-0 left-0 bg-white z-40"
    >
      <p class="text-xs sm:text-sm md:text-base text-center">
        CopyRight &copy; DUPA & GUINITA
      </p>
    </footer>

    <script>
      const hamburgerIcon = document.getElementById("hamburger-icon");
      const sidebar = document.getElementById("sidebar");
      const overlay = document.getElementById("overlay");

      hamburgerIcon.addEventListener("click", () => {
        sidebar.classList.toggle("active");
        overlay.classList.toggle("active");
      });

      overlay.addEventListener("click", () => {
        sidebar.classList.remove("active");
        overlay.classList.remove("active");
      });

      const sidebarLinks = sidebar.querySelectorAll("a");
      sidebarLinks.forEach((link) => {
        link.addEventListener("click", () => {
          sidebar.classList.remove("active");
          overlay.classList.remove("active");
        });
      });

      // Auto-hide flash messages after 3 seconds
      setTimeout(() => {
        const flashMessages = document.querySelectorAll(
          '[class*="bg-red-500"], [class*="bg-green-500"]'
        );
        flashMessages.forEach((msg) => {
          msg.style.opacity = "0";
          msg.style.transition = "opacity 0.5s";
          setTimeout(() => msg.remove(), 500);
        });
      }, 3000);
    </script>
  </body>
</html>
