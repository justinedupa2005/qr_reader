<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../static/css/style.css" />
  </head>
  <body>
    <!-- Header -->
    <header
      class="w-full h-[10vh] min-h-[60px] flex items-center bg-blue-600 px-4 fixed top-0 left-0 z-50"
    >
      <p class="text-white text-sm sm:text-base md:text-lg">
        Python (19877) 8:00-10:30 MW
      </p>
    </header>

    <!-- Hamburger Menu - Mobile only -->
    <div
      class="w-full h-[10vh] flex items-center fixed top-[10vh] left-0 z-40 px-4 lg:hidden bg-white"
    >
      <img
        src="https://cdn-icons-png.flaticon.com/512/1828/1828859.png"
        alt="Menu"
        id="hamburger-icon"
        class="w-6 h-6 cursor-pointer"
      />
    </div>

    <!-- Sidebar -->
    <aside id="sidebar">
      <a href="{{ url_for('admin') }}">User Management</a>
      <a href="{{ url_for('dashboard') }}">Student Management</a>
      <a href="#">Attendance</a>
      <a href="{{ url_for('signin') }}">Logout</a>
    </aside>

    <!-- Overlay -->
    <div id="overlay"></div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %}
    <div class="fixed top-[11vh] left-1/2 transform -translate-x-1/2 z-50 w-96">
      {% for category, message in messages %}
      <div
        class="bg-{% if category == 'error' %}red{% else %}green{% endif %}-500 text-white px-6 py-3 rounded-lg shadow-lg mb-2"
      >
        {{ message }}
      </div>
      {% endfor %}
    </div>
    {% endif %} {% endwith %}

    <!-- Main Content Area -->
    <div class="content-wrapper">
      <!-- Desktop Layout (lg and up) -->
      <div class="hidden lg:flex h-full">
        <!-- Left Column - Student Profile (30%) -->
        <div class="w-[30%] p-4 overflow-y-auto">
          <p class="text-xl font-semibold text-black mb-4">
            Student Management
          </p>

          <div class="bg-white border-2 border-gray-300 rounded-lg p-6">
            <!-- Student Image -->
            <div class="w-full flex justify-center mb-6">
              {% if student and student['image'] %}
              <img
                src="{{ url_for('static', filename='uploads/' + student['image']) }}"
                alt="student-photo"
                class="w-32 h-32 rounded-full object-cover border-4 border-gray-300"
              />
              {% else %}
              <img
                src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
                alt="user-icon"
                class="w-16 h-16"
              />
              {% endif %}
            </div>

            <!-- Form - View Only -->
            <div class="w-full flex flex-col gap-4">
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['idno'] }}{% else %}IDNO{% endif %}"
                readonly
              />
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['lastname'] }}{% else %}Last Name{% endif %}"
                readonly
              />
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['firstname'] }}{% else %}First Name{% endif %}"
                readonly
              />
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['course'] }}{% else %}Course{% endif %}"
                readonly
              />
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['level'] }}{% else %}Level{% endif %}"
                readonly
              />
            </div>
          </div>
        </div>

        <!-- Right Column - Student Table (70%) -->
        <div class="w-[70%] p-4 overflow-y-auto">
          <div class="bg-white rounded-lg shadow-lg">
            <div class="flex justify-end p-4">
              <a
                href="{{ url_for('add_student_page') }}"
                class="text-white px-4 py-2 rounded-md bg-blue-500 hover:bg-blue-600"
              >
                + ADD STUDENT
              </a>
            </div>

            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-blue-600">
                  <tr>
                    <th
                      class="px-3 lg:px-5 py-3 text-left text-xs font-semibold text-white uppercase"
                    >
                      ID
                    </th>
                    <th
                      class="px-3 lg:px-5 py-3 text-left text-xs font-semibold text-white uppercase"
                    >
                      IDNO
                    </th>

                    <!-- FULL NAME (visible until xl) -->
                    <th
                      class="px-4 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap xl:hidden"
                    >
                      FULL NAME
                    </th>

                    <!-- LAST NAME (visible only on xl) -->
                    <th
                      class="hidden xl:table-cell px-4 lg:px-8 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap"
                    >
                      LAST NAME
                    </th>

                    <!-- FIRST NAME (visible only on xl) -->
                    <th
                      class="hidden xl:table-cell px-4 lg:px-8 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap"
                    >
                      FIRST NAME
                    </th>

                    <!-- COURSE & LEVEL (visible until xl) -->
                    <th
                      class="px-3 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap xl:hidden"
                    >
                      COURSE & LEVEL
                    </th>

                    <!-- COURSE (only xl) -->
                    <th
                      class="hidden xl:table-cell px-3 lg:px-5 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap"
                    >
                      COURSE
                    </th>

                    <!-- LEVEL (only xl) -->
                    <th
                      class="hidden xl:table-cell px-3 lg:px-5 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap"
                    >
                      LEVEL
                    </th>

                    <th
                      class="px-4 lg:px-8 py-3 text-left text-xs font-semibold text-white uppercase"
                    >
                      ACTION
                    </th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                  {% if studentlist %} {% for stud in studentlist %}
                  <tr>
                    <td class="px-3 lg:px-5 py-4 text-sm text-gray-900">
                      {{ loop.index }}
                    </td>
                    <td class="px-3 lg:px-5 py-4 text-sm text-gray-900">
                      {{ stud['idno'] }}
                    </td>
                    <td class="px-4 py-4 text-sm text-gray-900 xl:hidden">
                      {{ stud['firstname'] }} {{ stud['lastname'] }}
                    </td>
                    <td
                      class="hidden xl:table-cell px-4 lg:px-10 py-4 text-sm text-gray-900"
                    >
                      {{ stud['lastname'] }}
                    </td>
                    <td
                      class="hidden xl:table-cell px-4 lg:px-10 py-4 text-sm text-gray-900"
                    >
                      {{ stud['firstname'] }}
                    </td>
                    <td class="px-3 py-4 text-sm text-gray-900 xl:hidden">
                      {{ stud['course'] }} - {{ stud['level'] }}
                    </td>
                    <td
                      class="hidden xl:table-cell px-3 lg:px-7 py-4 text-sm text-gray-900"
                    >
                      {{ stud['course'] }}
                    </td>
                    <td
                      class="hidden xl:table-cell px-3 lg:px-8 py-4 text-sm text-gray-900"
                    >
                      {{ stud['level'] }}
                    </td>
                    <td class="px-4 py-4 text-sm whitespace-nowrap">
                      <a
                        href="{{ url_for('view_student', idno=stud['idno']) }}"
                        class="text-green-600 hover:text-green-800 mr-3"
                        >üëÅÔ∏è</a
                      >
                      <a
                        href="{{ url_for('update_student', idno=stud['idno']) }}"
                        class="text-blue-600 hover:text-blue-800 mr-3"
                        >&#128393;</a
                      >
                      <a
                        href="{{ url_for('delete_student', idno=stud['idno']) }}"
                        onclick="return confirm('Are you sure you want to delete this student?')"
                        class="text-red-600 hover:text-red-800"
                        >&#9003;</a
                      >
                    </td>
                  </tr>
                  {% endfor %} {% else %}
                  <tr>
                    <td colspan="9" class="px-6 py-4 text-center text-gray-500">
                      No students found
                    </td>
                  </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile/Tablet Layout (below lg) -->
      <div class="lg:hidden px-4 py-4 pt-[10vh] h-full overflow-y-auto">
        <!-- Student Profile Section -->
        <div class="w-full flex justify-center mb-8">
          <div
            class="w-full max-w-2xl bg-white border-2 border-gray-300 rounded-lg p-6"
          >
            <p class="text-xl font-semibold text-black mb-4">
              Student Management
            </p>

            <!-- Student Image -->
            <div class="w-full flex justify-center mb-6">
              {% if student and student['image'] %}
              <img
                src="{{ url_for('static', filename='uploads/' + student['image']) }}"
                alt="student-photo"
                class="w-32 h-32 rounded-full object-cover border-4 border-gray-300"
              />
              {% else %}
              <img
                src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
                alt="user-icon"
                class="w-28 h-28"
              />
              {% endif %}
            </div>

            <!-- Form - View Only -->
            <div class="w-full flex flex-col gap-4">
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['idno'] }}{% else %}IDNO{% endif %}"
                readonly
              />
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['lastname'] }}{% else %}Last Name{% endif %}"
                readonly
              />
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['firstname'] }}{% else %}First Name{% endif %}"
                readonly
              />
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['course'] }}{% else %}Course{% endif %}"
                readonly
              />
              <input
                type="text"
                class="border p-2 rounded w-full bg-gray-100 text-gray-700 cursor-not-allowed"
                value="{% if student %}{{ student['level'] }}{% else %}Level{% endif %}"
                readonly
              />
            </div>
          </div>
        </div>

        <!-- Student Table -->
        <div class="w-full flex justify-center mb-8">
          <div
            class="w-full max-w-4xl bg-white rounded-lg overflow-hidden shadow-lg"
          >
            <div class="flex justify-end p-4">
              <a
                href="{{ url_for('add_student_page') }}"
                class="text-white px-4 py-2 rounded-md bg-blue-500 hover:bg-blue-600"
              >
                + ADD STUDENT
              </a>
            </div>

            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-blue-600">
                  <tr>
                    <th
                      class="px-3 py-3 text-left text-xs font-semibold text-white uppercase"
                    >
                      ID
                    </th>
                    <th
                      class="px-3 py-3 text-left text-xs font-semibold text-white uppercase"
                    >
                      IDNO
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap"
                    >
                      FULL NAME
                    </th>
                    <th
                      class="px-3 py-3 text-left text-xs font-semibold text-white uppercase whitespace-nowrap"
                    >
                      COURSE & LEVEL
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-semibold text-white uppercase"
                    >
                      ACTION
                    </th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                  {% if studentlist %} {% for stud in studentlist %}
                  <tr>
                    <td class="px-3 py-4 text-sm text-gray-900">
                      {{ loop.index }}
                    </td>
                    <td class="px-3 py-4 text-sm text-gray-900">
                      {{ stud['idno'] }}
                    </td>
                    <td class="px-4 py-4 text-sm text-gray-900">
                      {{ stud['firstname'] }} {{ stud['lastname'] }}
                    </td>
                    <td class="px-3 py-4 text-sm text-gray-900">
                      {{ stud['course'] }} - {{ stud['level'] }}
                    </td>
                    <td class="px-4 py-4 text-sm whitespace-nowrap">
                      <a
                        href="{{ url_for('view_student', idno=stud['idno']) }}"
                        class="text-green-600 hover:text-green-800 mr-1"
                        >üëÅÔ∏è</a
                      >
                      <a
                        href="{{ url_for('update_student', idno=stud['idno']) }}"
                        class="text-blue-600 hover:text-blue-800 mr-1"
                        >&#128393;</a
                      >
                      <a
                        href="{{ url_for('delete_student', idno=stud['idno']) }}"
                        onclick="return confirm('Are you sure?')"
                        class="text-red-600 hover:text-red-800"
                        >&#9003;</a
                      >
                    </td>
                  </tr>
                  {% endfor %} {% else %}
                  <tr>
                    <td colspan="5" class="px-4 py-4 text-center text-gray-500">
                      No students found
                    </td>
                  </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer
      class="w-full h-[10vh] min-h-[60px] flex justify-center items-center border-t-2 border-t-gray-200 fixed bottom-0 left-0 bg-white"
    >
      <p class="text-xs sm:text-sm md:text-base text-center">
        CopyRight &copy; DUPA & GUINITA
      </p>
    </footer>

    <script>
      const hamburgerIcon = document.getElementById("hamburger-icon");
      const sidebar = document.getElementById("sidebar");
      const overlay = document.getElementById("overlay");

      if (hamburgerIcon) {
        hamburgerIcon.addEventListener("click", () => {
          sidebar.classList.toggle("active");
          overlay.classList.toggle("active");
        });
      }

      if (overlay) {
        overlay.addEventListener("click", () => {
          sidebar.classList.remove("active");
          overlay.classList.remove("active");
        });
      }

      const sidebarLinks = sidebar.querySelectorAll("a");
      sidebarLinks.forEach((link) => {
        link.addEventListener("click", () => {
          sidebar.classList.remove("active");
          overlay.classList.remove("active");
        });
      });

      // Auto-hide flash messages after 3 seconds
      setTimeout(() => {
        const flashMessages = document.querySelectorAll(
          '[class*="bg-red-500"], [class*="bg-green-500"]'
        );
        flashMessages.forEach((msg) => {
          msg.style.opacity = "0";
          msg.style.transition = "opacity 0.5s";
          setTimeout(() => msg.remove(), 500);
        });
      }, 3000);
    </script>
  </body>
</html>
